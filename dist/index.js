'use strict';var P=require('near-api-js'),walletUtils=require('@near-wallet-selector/wallet-utils');function _interopNamespace(e){if(e&&e.__esModule)return e;var n=Object.create(null);if(e){Object.keys(e).forEach(function(k){if(k!=='default'){var d=Object.getOwnPropertyDescriptor(e,k);Object.defineProperty(n,k,d.get?d:{enumerable:true,get:function(){return e[k]}});}})}n.default=e;return Object.freeze(n)}var P__namespace=/*#__PURE__*/_interopNamespace(P);var W=e=>{function l(s){return /^(https?|ftp|http?):\/\/[^\s/$.?#].[^\s]*$/.test(s)}if(e!==null&&e.length>0)if(l(e)){if(e.startsWith("https://")||e.startsWith("http://"))return e.endsWith("/")?e.slice(0,-1):e}else return console.error("callbackUrl set with wrong format. please use an URL with http:// or https:// instead.Further help available on our telegram channel: https://t.me/mintdev"),new URL(window.location.href).toString();else {let s=localStorage.getItem("mintbase-wallet:callback_url");return l(s)?s:(console.warn(`We recommend you to set the callbackUrl property on setupMintbaseWallet  
 read more here:  
 https://docs.mintbase.xyz/dev/mintbase-sdk-ref/wallet#setupmintbasewallet  
  
 further help available on our telegram channel:  
 https://t.me/mintdev`),new URL(window.location.href).toString())}return new URL(window.location.href).toString()},j=e=>{if(typeof window!==undefined){let l="";window?.mbjs?.keys?.callbackUrl&&window?.mbjs?.keys?.callbackUrl.length>0&&(l=window?.mbjs?.keys?.callbackUrl);let s=localStorage?.getItem("mintbase-wallet:callback_url")||l;return {cbUrl:W(e??s)}}return null};var L=(e,l)=>{if(l)return l;switch(e){case "mainnet":return "https://wallet.bitte.ai";case "testnet":return "https://testnet.wallet.bitte.ai/";default:throw new Error("Invalid wallet url")}};var O=async({metadata:e,options:l,successUrl:s,failureUrl:g,contractId:c,callback:w,networkId:D})=>{let i=await(async()=>{if(typeof window!==undefined){let{connect:t,WalletConnection:a,keyStores:o}=P__namespace,M={networkId:D,keyStore:new o.BrowserLocalStorageKeyStore,nodeUrl:l.network.nodeUrl,walletUrl:e.walletUrl,headers:{}},n=new URL(window.location.href).searchParams.get("account_id");n&&!c&&localStorage.setItem("mintbase-wallet_wallet_auth_key",JSON.stringify({accountId:n,allKeys:[]}));let u=await t(M),r=new a(u,"mintbase-wallet");return localStorage.setItem("mintbase-wallet:callback_url",w),{wallet:r}}return null})(),I,d=()=>I,U=async()=>!!I,m=async()=>{let t=await z(),a=encodeURI(window?.location?.href);return t.length?t:(await i.wallet.requestSignIn({methodNames:[],successUrl:s||a,failureUrl:g||a,contractId:c}),z())},h=async()=>{window.localStorage.removeItem("mintbase-wallet:account-data"),i.wallet.isSignedIn()&&i.wallet.signOut();},T=t=>{if(t&&t!==i.wallet.getAccountId())throw new Error(`Cannot sign transactions for ${t} while signed in as ${I}`)},S=async({transactions:t,callbackUrl:a})=>{if(!i.wallet.isSignedIn())throw new Error("Wallet not signed in");let{cbUrl:o}=j(a??"");for(let{signerId:u}of t)T(u);let M=JSON.stringify(t),N=encodeURIComponent(M),n=new URL(`${e.walletUrl}/sign-transaction`);n.searchParams.set("transactions_data",N),n.searchParams.set("callback_url",o),window.location.assign(n.toString());},b=async({receiverId:t,actions:a,signerId:o,callbackUrl:M})=>{if(T(o),!t&&!c)throw new Error("No receiver found to send the transaction to");let{cbUrl:N}=j(M??""),n=N||s;if(!c){let r=new URL(`${e.walletUrl}/sign-transaction`),y=JSON.stringify([{receiverId:t,signerId:o,actions:a}]),A=encodeURIComponent(y);r.searchParams.set("transactions_data",A),r.searchParams.set("callback_url",n),window.location.assign(r.toString());}return await i.wallet.account().signAndSendTransaction({receiverId:t||c,actions:a.map(r=>walletUtils.createAction(r)),walletCallbackUrl:n})},f=async()=>{throw new Error(`The verifyOwner method is not supported by ${e.name}`)},p=async({message:t,nonce:a,recipient:o,callbackUrl:M})=>{let{cbUrl:N}=j(M??""),n=new URL(`${e.walletUrl}/sign-message`);n.searchParams.set("message",t),n.searchParams.set("nonce",Buffer.from(a).toString("base64")),n.searchParams.set("recipient",o),n.searchParams.set("callbackUrl",N),window.location.assign(n.toString());},E=async({accountId:t,publicKey:a,signature:o,message:M,nonce:N,recipient:n,callbackUrl:u})=>{let r=new URL(`${e.walletUrl}/api/verify-message`);r.searchParams.set("message",M),r.searchParams.set("accountId",t),r.searchParams.set("publicKey",a),r.searchParams.set("signature",o),r.searchParams.set("nonce",Buffer.from(N).toString("base64")),r.searchParams.set("recipient",n),r.searchParams.set("callbackUrl",u);try{let A=await(await fetch(r.toString())).json(),{isValid:Y}=A;return Y}catch{return  false}},Q=async()=>{throw `The getAvailableBalance method is not supported by ${e.name}`},z=async()=>{let t=i.wallet.getAccountId(),a=i.wallet.account();if(!t||!a)return [];let o=window.localStorage.getItem("mintbase-wallet:account-creation-data");return [{accountId:t,publicKey:JSON.parse(o)?.devicePublicKey}]},C=async t=>(x(t),null),x=t=>(I=t,window.localStorage.setItem("mintbase-wallet:activeAccountId",t),null);return {getAccountId:d,isSignedIn:U,signIn:m,signOut:h,signAndSendTransaction:b,verifyOwner:f,signMessage:p,getAvailableBalance:Q,getAccounts:z,switchAccount:C,signAndSendTransactions:S,verifyMessage:E}};var B="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTUiIGhlaWdodD0iOTUiIHZpZXdCb3g9IjAgMCA5NSA5NSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xLjc3NjE3IDU5LjE4MjZMNjIuNzIyNyA2My4zMTNDNjMuMTE4NSA2My40MzA5IDYzLjQ3ODggNjMuNjQ1NiA2My43NzA4IDYzLjkzNzdDNjQuMDYyOSA2NC4yMjk3IDY0LjI3NzUgNjQuNTg5OSA2NC4zOTU0IDY0Ljk4NThMNjguNTI1OSA3OC44NTU1QzY4LjY3ODcgNzkuMzY4NiA2OC45OTMyIDc5LjgxODYgNjkuNDIyNCA4MC4xMzg3QzY5Ljg1MTYgODAuNDU4NyA3MC4zNzI3IDgwLjYzMTYgNzAuOTA4MiA4MC42MzE2QzcxLjQ0MzYgODAuNjMxNiA3MS45NjQ3IDgwLjQ1ODcgNzIuMzkzOSA4MC4xMzg3QzcyLjgyMzEgNzkuODE4NiA3My4xMzc2IDc5LjM2ODYgNzMuMjkwNCA3OC44NTU1TDc3LjQyMDkgNjQuOTg1OEM3Ny41Mzg4IDY0LjU4OTkgNzcuNzUzNCA2NC4yMjk3IDc4LjA0NTUgNjMuOTM3N0M3OC4zMzc2IDYzLjY0NTYgNzguNjk3OCA2My40MzA5IDc5LjA5MzYgNjMuMzEzTDkyLjk2MzMgNTkuMTgyNkM5My40NzY0IDU5LjAyOTcgOTMuOTI2NSA1OC43MTUzIDk0LjI0NjYgNTguMjg2MUM5NC41NjY2IDU3Ljg1NjggOTQuNzM5NSA1Ny4zMzU3IDk0LjczOTUgNTYuODAwM0M5NC43Mzk1IDU2LjI2NDkgOTQuNTY2NiA1NS43NDM4IDk0LjI0NjYgNTUuMzE0NkM5My45MjY1IDU0Ljg4NTMgOTMuNDc2NCA1NC41NzA5IDkyLjk2MzMgNTQuNDE4MUw3OS4wOTM3IDUwLjI4NzZDNzguNjk3OCA1MC4xNjk3IDc4LjMzNzYgNDkuOTU1IDc4LjA0NTUgNDkuNjYzQzc3Ljc1MzUgNDkuMzcwOSA3Ny41Mzg4IDQ5LjAxMDcgNzcuNDIwOSA0OC42MTQ4TDczLjI5MDQgMzQuNzQ1MkM3My4xMzc2IDM0LjIzMiA3Mi44MjMyIDMzLjc4MTkgNzIuMzkzOSAzMy40NjE5QzcxLjk2NDcgMzMuMTQxOSA3MS40NDM2IDMyLjk2OSA3MC45MDgyIDMyLjk2OUM3MC4zNzI4IDMyLjk2OSA2OS44NTE3IDMzLjE0MTkgNjkuNDIyNCAzMy40NjE5QzY4Ljk5MzIgMzMuNzgxOSA2OC42Nzg4IDM0LjIzMiA2OC41MjYgMzQuNzQ1Mkw2NC4zOTU0IDQ4LjYxNDhDNjQuMjc3NiA0OS4wMTA3IDY0LjA2MjkgNDkuMzcwOSA2My43NzA4IDQ5LjY2M0M2My40Nzg4IDQ5Ljk1NSA2My4xMTg1IDUwLjE2OTcgNjIuNzIyNyA1MC4yODc2TDEuNzc2MTggNTQuNDE4MUMxLjI2MzA1IDU0LjU3MDkgMC44MTI5NTYgNTQuODg1MyAwLjQ5MjkyIDU1LjMxNDZDMC4xNzI4ODQgNTUuNzQzOCAyLjI0NzU1ZS0wNiA1Ni4yNjQ5IDAgNTYuODAwM0MtMi4yNDc1MWUtMDYgNTcuMzM1NyAwLjE3Mjg4NyA1Ny44NTY4IDAuNDkyOTIgNTguMjg2MUMwLjgxMjk1MyA1OC43MTUzIDEuMjYzMDMgNTkuMDI5NyAxLjc3NjE3IDU5LjE4MjZaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTMyLjE2MzcgMjkuNDg2OEw0MC4zNTc4IDMxLjkyNzFDNDAuNTkxNyAzMS45OTY3IDQwLjgwNDUgMzIuMTIzNiA0MC45NzcgMzIuMjk2MUM0MS4xNDk2IDMyLjQ2ODcgNDEuMjc2NCAzMi42ODE1IDQxLjM0NjEgMzIuOTE1NEw0My43ODYzIDQxLjEwOTVDNDMuODc2NiA0MS40MTI2IDQ0LjA2MjQgNDEuNjc4NSA0NC4zMTYgNDEuODY3NkM0NC41Njk2IDQyLjA1NjcgNDQuODc3NCA0Mi4xNTg4IDQ1LjE5MzcgNDIuMTU4OEM0NS41MTAxIDQyLjE1ODggNDUuODE3OSA0Mi4wNTY3IDQ2LjA3MTUgNDEuODY3NkM0Ni4zMjUxIDQxLjY3ODUgNDYuNTEwOSA0MS40MTI2IDQ2LjYwMTEgNDEuMTA5NUw0OS4wNDE0IDMyLjkxNTRDNDkuMTExMSAzMi42ODE1IDQ5LjIzNzkgMzIuNDY4NyA0OS40MTA0IDMyLjI5NjFDNDkuNTgzIDMyLjEyMzYgNDkuNzk1OCAzMS45OTY3IDUwLjAyOTcgMzEuOTI3MUw1OC4yMjM4IDI5LjQ4NjhDNTguNTI2OSAyOS4zOTY2IDU4Ljc5MjggMjkuMjEwOCA1OC45ODE5IDI4Ljk1NzJDNTkuMTcxIDI4LjcwMzYgNTkuMjczMSAyOC4zOTU4IDU5LjI3MzEgMjguMDc5NEM1OS4yNzMxIDI3Ljc2MzEgNTkuMTcxIDI3LjQ1NTMgNTguOTgxOSAyNy4yMDE3QzU4Ljc5MjggMjYuOTQ4MSA1OC41MjY5IDI2Ljc2MjMgNTguMjIzOCAyNi42NzJMNTAuMDI5NiAyNC4yMzE3QzQ5Ljc5NTggMjQuMTYyMSA0OS41ODI5IDI0LjAzNTIgNDkuNDEwNCAyMy44NjI3QzQ5LjIzNzkgMjMuNjkwMiA0OS4xMTEgMjMuNDc3MyA0OS4wNDE0IDIzLjI0MzRMNDYuNjAxMSAxNS4wNDkzQzQ2LjUxMDggMTQuNzQ2MiA0Ni4zMjUgMTQuNDgwMyA0Ni4wNzE1IDE0LjI5MTJDNDUuODE3OSAxNC4xMDIxIDQ1LjUxIDE0IDQ1LjE5MzcgMTRDNDQuODc3NCAxNCA0NC41Njk1IDE0LjEwMjEgNDQuMzE1OSAxNC4yOTEyQzQ0LjA2MjMgMTQuNDgwMyA0My44NzY2IDE0Ljc0NjIgNDMuNzg2MyAxNS4wNDkzTDQxLjM0NiAyMy4yNDM0QzQxLjI3NjQgMjMuNDc3MyA0MS4xNDk1IDIzLjY5MDIgNDAuOTc3IDIzLjg2MjdDNDAuODA0NCAyNC4wMzUyIDQwLjU5MTYgMjQuMTYyMSA0MC4zNTc4IDI0LjIzMTdMMzIuMTYzNyAyNi42NzJDMzEuODYwNSAyNi43NjIyIDMxLjU5NDYgMjYuOTQ4IDMxLjQwNTUgMjcuMjAxNkMzMS4yMTY0IDI3LjQ1NTIgMzEuMTE0MyAyNy43NjMxIDMxLjExNDMgMjguMDc5NEMzMS4xMTQzIDI4LjM5NTggMzEuMjE2NCAyOC43MDM3IDMxLjQwNTUgMjguOTU3MkMzMS41OTQ2IDI5LjIxMDggMzEuODYwNSAyOS4zOTY2IDMyLjE2MzcgMjkuNDg2OFoiIGZpbGw9ImJsYWNrIi8+Cjwvc3ZnPgo=";function v({walletUrl:e="",deprecated:l=false,successUrl:s="",failureUrl:g="",callbackUrl:c="",contractId:w=""}={}){return async D=>({id:"bitte-wallet",type:"browser",metadata:{name:"Bitte Wallet",description:"NEAR wallet to store, buy, send and stake assets for DeFi.",iconUrl:B,deprecated:l,available:true,successUrl:s,failureUrl:g,walletUrl:L(D.options.network.networkId,e)},init:i=>O({callback:c,networkId:D.options.network.networkId,successUrl:s,failureUrl:g,contractId:w,...i})})}
exports.setupBitteWallet=v;//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map