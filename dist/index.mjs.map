{"version":3,"sources":["../src/bitte-wallet.ts","../src/utils.ts","../src/bitte-wallet-setup.ts"],"sourcesContent":["import * as nearAPI from 'near-api-js';\n\nimport type {\n  Action,\n  BrowserWallet,\n  FinalExecutionOutcome,\n  WalletBehaviourFactory,\n} from '@near-wallet-selector/core';\nimport { getCallbackUrl } from './utils';\nimport { createAction } from '@near-wallet-selector/wallet-utils';\n\n\nexport enum TransactionSuccessEnum {\n  MINT = 'mint',\n  TRANSFER = 'transfer',\n  BURN = 'burn',\n  DEPLOY_STORE = 'deploy-store',\n  MAKE_OFFER = 'make-offer',\n  REVOKE_MINTER = 'revoke-minter',\n  ADD_MINTER = 'add-minter',\n  TRANSFER_STORE_OWNERSHIP = 'transfer-store-ownership',\n  AUCTION_LIST = 'list',\n  SIMPLE_SALE_LIST = 'simple-sale-list',\n  UNLIST = 'unlist',\n  TAKE_OFFER = 'take-offer',\n  WITHDRAW_OFFER = 'withdraw-offer',\n}\n\ninterface BitteWalletState {\n  wallet: nearAPI.WalletConnection;\n}\n\ninterface BitteWalletAccount {\n  accountId: string;\n  publicKey: string;\n}\n\nexport type CallBackArgs = {\n  args:  Record<string, unknown>;\n  type: TransactionSuccessEnum;\n}\n\n\nexport const BitteWallet: WalletBehaviourFactory<\n  BrowserWallet,\n  {\n    networkId: string;\n    callback: string;\n    successUrl?: string;\n    failureUrl?: string;\n    contractId?: string;\n  }\n> = async ({\n  metadata,\n  options,\n  successUrl,\n  failureUrl,\n  contractId,\n  callback,\n  networkId,\n}) => {\n\n  const setupWalletState = async (): Promise<BitteWalletState> | null => {\n    if (typeof window !== undefined) {\n      const { connect, WalletConnection, keyStores } = nearAPI;\n      const connectionConfig = {\n        networkId: networkId,\n        keyStore: new keyStores.BrowserLocalStorageKeyStore(),\n        nodeUrl: options.network.nodeUrl,\n        walletUrl: metadata.walletUrl,\n        headers: {},\n      };\n\n      const searchParams = new URL(window.location.href);\n      const acc = searchParams.searchParams.get('account_id');\n      //make near-api-js not throw without lak\n      if (acc && !contractId) {\n        localStorage.setItem(\n          'mintbase-wallet_wallet_auth_key',\n          JSON.stringify({\n            accountId: acc as string,\n            allKeys: [],\n          }),\n        );\n      }\n\n      const nearConnection = await connect(connectionConfig);\n      const wallet = new WalletConnection(nearConnection, 'mintbase-wallet');\n      localStorage.setItem('mintbase-wallet:callback_url', callback);\n\n      return {\n        wallet,\n      };\n    }\n\n    return null;\n  };\n\n  const state = await setupWalletState();\n\n  let activeAccountId: string;\n\n  const getAccountId = (): string => activeAccountId;\n\n  const isSignedIn = async (): Promise<boolean> => !!activeAccountId;\n\n  const signIn = async (): Promise<BitteWalletAccount[]> => {\n    const existingAccounts = await getAccounts();\n    const href = encodeURI(window?.location?.href);\n\n    if (existingAccounts.length) {\n      return existingAccounts;\n    }\n\n    await state.wallet.requestSignIn({\n      methodNames: [],\n      successUrl: successUrl || href,\n      failureUrl: failureUrl || href,\n      contractId: contractId,\n    });\n\n    return getAccounts();\n  };\n\n  const signOut = async (): Promise<void> => {\n    window.localStorage.removeItem('mintbase-wallet:account-data');\n\n    if (state.wallet.isSignedIn()) {\n      state.wallet.signOut();\n    }\n\n    return;\n  };\n\n\n  const assertValidSigner = (signerId: string): void => {\n    if (signerId && signerId !== state.wallet.getAccountId()) {\n      throw new Error(\n        `Cannot sign transactions for ${signerId} while signed in as ${activeAccountId}`,\n      );\n    }\n  };\n\n  const signAndSendTransactions = async ({ transactions, callbackUrl }): Promise<void> => {\n    if (!state.wallet.isSignedIn()) {\n      throw new Error('Wallet not signed in');\n    }\n    //// near-api-js code fails if no lak\n    // const { cbUrl } = getCallbackUrl(callbackUrl ?? '');\n\n    // return state.wallet.requestSignTransactions({\n    //   transactions: await transformTransactions(transactions),\n    //   callbackUrl: cbUrl,\n    // });\n\n    const { cbUrl } = getCallbackUrl(callbackUrl ?? '');\n\n    for (const { signerId } of transactions) {\n      assertValidSigner(signerId);\n    }\n    const stringifiedParam = JSON.stringify(transactions);\n\n    const urlParam = encodeURIComponent(stringifiedParam);\n    const newUrl = new URL(`${metadata.walletUrl}/sign-transaction`);\n    newUrl.searchParams.set('transactions_data', urlParam);\n    newUrl.searchParams.set('callback_url', cbUrl);\n\n    window.location.assign(newUrl.toString());\n    return;\n  };\n\n  const signAndSendTransaction =  async ({\n    receiverId,\n    actions,\n    signerId,\n    callbackUrl,\n  }: {\n    receiverId: string;\n    actions: Array<Action>;\n    signerId: string;\n    callbackUrl: string;\n  }): Promise<FinalExecutionOutcome> => {\n    assertValidSigner(signerId);\n\n    if (!receiverId && !contractId) {\n      throw new Error('No receiver found to send the transaction to');\n    }\n\n    const { cbUrl } = getCallbackUrl(callbackUrl ?? '');\n\n    const callback = cbUrl || successUrl;\n\n    if (!contractId) {\n      const newUrl = new URL(`${metadata.walletUrl}/sign-transaction`);\n      const stringifiedParam = JSON.stringify([{ receiverId, signerId, actions }]);\n      const urlParam = encodeURIComponent(stringifiedParam);\n      newUrl.searchParams.set('transactions_data', urlParam);\n      newUrl.searchParams.set('callback_url', callback);\n      window.location.assign(newUrl.toString());\n    }\n    const account = state.wallet.account();\n\n    return await account.signAndSendTransaction({\n      receiverId: receiverId || contractId,\n      actions: actions.map((action) => createAction(action)) as any,\n      walletCallbackUrl: callback,\n    });\n  };\n\n\n  const verifyOwner = async (): Promise<void> => {\n    throw new Error(`The verifyOwner method is not supported by ${metadata.name}`);\n  };\n\n  const signMessage = async ({ message, nonce, recipient, callbackUrl }): Promise<void> => {\n    const { cbUrl } = getCallbackUrl(callbackUrl ?? '');\n\n    const newUrl = new URL(`${metadata.walletUrl}/sign-message`);\n    newUrl.searchParams.set('message', message);\n    newUrl.searchParams.set('nonce', Buffer.from(nonce).toString('base64'));\n    newUrl.searchParams.set('recipient', recipient);\n    newUrl.searchParams.set('callbackUrl', cbUrl);\n    window.location.assign(newUrl.toString());\n  };\n\n  const verifyMessage = async ({ accountId, publicKey, signature, message, nonce, recipient, callbackUrl }): Promise<boolean> => {\n\n    const newUrl = new URL(`${metadata.walletUrl}/api/verify-message`);\n    newUrl.searchParams.set('message', message);\n    newUrl.searchParams.set('accountId', accountId);\n    newUrl.searchParams.set('publicKey', publicKey);\n    newUrl.searchParams.set('signature', signature);\n    newUrl.searchParams.set('nonce', Buffer.from(nonce).toString('base64'));\n    newUrl.searchParams.set('recipient', recipient);\n    newUrl.searchParams.set('callbackUrl', callbackUrl);\n\n    try {\n      const response = await fetch(newUrl.toString());\n      const data = await response.json();\n\n      const { isValid } = data;\n      return isValid;\n    } catch (e) {\n      return false;\n    }\n  };\n\n  const getAvailableBalance = async (): Promise<void> => {\n    // const accountId = state.wallet.getAccountId();\n    // return await getBalance(accountId);\n    throw (`The getAvailableBalance method is not supported by ${metadata.name}`);\n  };\n\n  const getAccounts = async (): Promise<BitteWalletAccount[]> => {\n    const accountId = state.wallet.getAccountId();\n    const account = state.wallet.account();\n\n    if (!accountId || !account) {\n      return [];\n    }\n\n    const currentAccount: string = window.localStorage.getItem(\n      'mintbase-wallet:account-creation-data',\n    )!;\n\n    return [\n      {\n        accountId,\n        publicKey: JSON.parse(currentAccount)?.devicePublicKey,\n      },\n    ];\n  };\n\n  const switchAccount = async (id: string): Promise<null> => {\n    //TODO fix\n    setActiveAccountId(id);\n\n    return null;\n  };\n\n  const setActiveAccountId = (accountId: string): null => {\n    activeAccountId = accountId;\n    window.localStorage.setItem('mintbase-wallet:activeAccountId', accountId);\n\n    return null;\n  };\n\n  // const transformTransactions = async (\n  //   transactions: Array<Optional<Transaction, 'signerId'>>,\n  // ): Promise<Array<nearAPI.transactions.Transaction>> => {\n  //   const account = state.wallet.account();\n  //   const { networkId, signer, provider } = account.connection;\n\n  //   const localKey = await signer.getPublicKey(account.accountId, networkId);\n\n  //   return Promise.all(\n  //     transactions.map(async (transaction, index) => {\n  //       const actions = transaction.actions.map((action) =>\n  //         createAction(action),\n  //       );\n  //       const accessKey = await account.accessKeyForTransaction(\n  //         transaction.receiverId,\n  //         actions as any,\n  //         localKey,\n  //       );\n\n  //       if (!accessKey) {\n  //         throw new Error(\n  //           `Failed to find matching key for transaction sent to ${transaction.receiverId}`,\n  //         );\n  //       }\n\n  //       const block = await provider.block({ finality: 'final' });\n\n  //       return nearAPI.transactions.createTransaction(\n  //         account.accountId,\n  //         nearAPI.utils.PublicKey.from(accessKey.public_key),\n  //         transaction.receiverId,\n  //         accessKey.access_key.nonce + index + 1,\n  //         actions as any,\n  //         nearAPI.utils.serialize.base_decode(block.header.hash),\n  //       );\n  //     }),\n  //   );\n  // };\n\n  return {\n    getAccountId,\n    isSignedIn,\n    signIn,\n    signOut,\n    signAndSendTransaction,\n    verifyOwner,\n    signMessage,\n    getAvailableBalance,\n    getAccounts,\n    switchAccount,\n    signAndSendTransactions,\n    verifyMessage,\n  };\n};\n","/*\n    Mintbase Wallet Utils file\n*/\n\n\nconst checkCallbackUrlBitte = (callbackUrl: string): string => {\n  function isValidURL(url): boolean {\n    const urlPattern = /^(https?|ftp|http?):\\/\\/[^\\s/$.?#].[^\\s]*$/;\n    return urlPattern.test(url);\n  }\n\n  if (callbackUrl !== null && callbackUrl.length > 0) {\n    if (isValidURL(callbackUrl)) {\n      if (\n        callbackUrl.startsWith('https://') ||\n        callbackUrl.startsWith('http://')\n      ) {\n        return callbackUrl.endsWith('/')\n          ? callbackUrl.slice(0, -1)\n          : callbackUrl;\n      }\n    } else {\n      console.error(\n        'callbackUrl set with wrong format. please use an URL with http:// or https:// instead.Further help available on our telegram channel: https://t.me/mintdev',\n      );\n      return new URL(window.location.href).toString();\n    }\n  } else {\n    const globalCallBackUrl = localStorage.getItem(\n      'bitte-wallet:callback_url',\n    );\n\n    if (isValidURL(globalCallBackUrl)) {\n      return globalCallBackUrl;\n    } else {\n      console.warn('We recommend you to set the callbackUrl property on setupMintbaseWallet  \\n read more here:  \\n https://docs.mintbase.xyz/dev/mintbase-sdk-ref/wallet#setupmintbasewallet  \\n  \\n further help available on our telegram channel:  \\n https://t.me/mintdev');\n      return new URL(window.location.href).toString();\n    }\n  }\n\n  return new URL(window.location.href).toString();\n};\n\n\nconst checkCallbackUrl = (callbackUrl: string): string => {\n  function isValidURL(url): boolean {\n    const urlPattern = /^(https?|ftp|http?):\\/\\/[^\\s/$.?#].[^\\s]*$/;\n    return urlPattern.test(url);\n  }\n\n  if (callbackUrl !== null && callbackUrl.length > 0) {\n    if (isValidURL(callbackUrl)) {\n      if (\n        callbackUrl.startsWith('https://') ||\n        callbackUrl.startsWith('http://')\n      ) {\n        return callbackUrl.endsWith('/')\n          ? callbackUrl.slice(0, -1)\n          : callbackUrl;\n      }\n    } else {\n      console.error(\n        'callbackUrl set with wrong format. please use an URL with http:// or https:// instead.Further help available on our telegram channel: https://t.me/mintdev',\n      );\n      return new URL(window.location.href).toString();\n    }\n  } else {\n    const globalCallBackUrl = localStorage.getItem(\n      'mintbase-wallet:callback_url',\n    );\n\n    if (isValidURL(globalCallBackUrl)) {\n      return globalCallBackUrl;\n    } else {\n      console.warn('We recommend you to set the callbackUrl property on setupMintbaseWallet  \\n read more here:  \\n https://docs.mintbase.xyz/dev/mintbase-sdk-ref/wallet#setupmintbasewallet  \\n  \\n further help available on our telegram channel:  \\n https://t.me/mintdev');\n      return new URL(window.location.href).toString();\n    }\n  }\n\n  return new URL(window.location.href).toString();\n};\n\nconst getCallbackUrl = (callbackUrl?: string): { cbUrl: string } | null => {\n  if (typeof window !== undefined) {\n\n    let mbjsCallbackUrl =  '';\n\n    if ( window?.['mbjs']?.keys?.callbackUrl && window?.['mbjs']?.keys?.callbackUrl.length > 0  ) {\n      mbjsCallbackUrl = window?.['mbjs']?.keys?.callbackUrl;\n    }\n\n    const globalCBUrl =  localStorage?.getItem('mintbase-wallet:callback_url') || mbjsCallbackUrl;\n\n    // it gets always the passed callBackUrl first, if not check for the one on the Wallet Setup or mbjs.keys.callbackUrl\n    const finalcbURL = callbackUrl ?? globalCBUrl;\n\n    const callBackUrlRes = checkCallbackUrl(finalcbURL);\n\n    // check if callBackUrl sent on the method is valid\n    // method callbackUrl will always have priority over global callbackUrl , user can set different callbackUrls according to the method..\n\n    return { cbUrl: callBackUrlRes };\n  }\n  return null;\n};\n\nconst getCallbackUrlBitte = (callbackUrl?: string): { cbUrl: string } | null => {\n  if (typeof window !== undefined) {\n\n    let mbjsCallbackUrl =  '';\n\n    if ( window?.['mbjs']?.keys?.callbackUrl && window?.['mbjs']?.keys?.callbackUrl.length > 0  ) {\n      mbjsCallbackUrl = window?.['mbjs']?.keys?.callbackUrl;\n    }\n\n    const globalCBUrl =  localStorage?.getItem('bitte-wallet:callback_url') || mbjsCallbackUrl;\n\n    // it gets always the passed callBackUrl first, if not check for the one on the Wallet Setup or mbjs.keys.callbackUrl\n    const finalcbURL = callbackUrl ?? globalCBUrl;\n\n    const callBackUrlRes = checkCallbackUrlBitte(finalcbURL);\n\n    // check if callBackUrl sent on the method is valid\n    // method callbackUrl will always have priority over global callbackUrl , user can set different callbackUrls according to the method..\n\n    return { cbUrl: callBackUrlRes };\n  }\n  return null;\n};\n\nconst resolveWalletUrl = (network: string, walletUrl?: string): string  => {\n  if (walletUrl) {\n    return walletUrl;\n  }\n\n  switch (network) {\n  case 'mainnet':\n    return 'https://wallet.mintbase.xyz';\n  case 'testnet':\n    return 'https://testnet.wallet.mintbase.xyz/';\n  default:\n    throw new Error('Invalid wallet url');\n  }\n};\n\nconst resolveBitteWallet = (network: string, walletUrl?: string): string  => {\n  if (walletUrl) {\n    return walletUrl;\n  }\n\n  switch (network) {\n  case 'mainnet':\n    return 'https://wallet.bitte.ai';\n  case 'testnet':\n    return 'https://testnet.wallet.bitte.ai/';\n  default:\n    throw new Error('Invalid wallet url');\n  }\n};\n\nexport { checkCallbackUrl,checkCallbackUrlBitte,  getCallbackUrl,getCallbackUrlBitte, resolveBitteWallet, resolveWalletUrl };\n\n","\nimport type {\n  BrowserWallet,\n  WalletModule,\n  WalletModuleFactory,\n} from '@near-wallet-selector/core';\nimport { BitteWallet } from './bitte-wallet';\nimport { resolveBitteWallet } from './utils';\n  \n  interface BitteWalletSetup {\n    callbackUrl?: string;\n    successUrl?: string;\n    walletUrl?: string;\n    failureUrl?: string;\n    deprecated?: boolean;\n    contractId?: string;\n    lak?: boolean;\n  }\n  \n  const icon = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTUiIGhlaWdodD0iOTUiIHZpZXdCb3g9IjAgMCA5NSA5NSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xLjc3NjE3IDU5LjE4MjZMNjIuNzIyNyA2My4zMTNDNjMuMTE4NSA2My40MzA5IDYzLjQ3ODggNjMuNjQ1NiA2My43NzA4IDYzLjkzNzdDNjQuMDYyOSA2NC4yMjk3IDY0LjI3NzUgNjQuNTg5OSA2NC4zOTU0IDY0Ljk4NThMNjguNTI1OSA3OC44NTU1QzY4LjY3ODcgNzkuMzY4NiA2OC45OTMyIDc5LjgxODYgNjkuNDIyNCA4MC4xMzg3QzY5Ljg1MTYgODAuNDU4NyA3MC4zNzI3IDgwLjYzMTYgNzAuOTA4MiA4MC42MzE2QzcxLjQ0MzYgODAuNjMxNiA3MS45NjQ3IDgwLjQ1ODcgNzIuMzkzOSA4MC4xMzg3QzcyLjgyMzEgNzkuODE4NiA3My4xMzc2IDc5LjM2ODYgNzMuMjkwNCA3OC44NTU1TDc3LjQyMDkgNjQuOTg1OEM3Ny41Mzg4IDY0LjU4OTkgNzcuNzUzNCA2NC4yMjk3IDc4LjA0NTUgNjMuOTM3N0M3OC4zMzc2IDYzLjY0NTYgNzguNjk3OCA2My40MzA5IDc5LjA5MzYgNjMuMzEzTDkyLjk2MzMgNTkuMTgyNkM5My40NzY0IDU5LjAyOTcgOTMuOTI2NSA1OC43MTUzIDk0LjI0NjYgNTguMjg2MUM5NC41NjY2IDU3Ljg1NjggOTQuNzM5NSA1Ny4zMzU3IDk0LjczOTUgNTYuODAwM0M5NC43Mzk1IDU2LjI2NDkgOTQuNTY2NiA1NS43NDM4IDk0LjI0NjYgNTUuMzE0NkM5My45MjY1IDU0Ljg4NTMgOTMuNDc2NCA1NC41NzA5IDkyLjk2MzMgNTQuNDE4MUw3OS4wOTM3IDUwLjI4NzZDNzguNjk3OCA1MC4xNjk3IDc4LjMzNzYgNDkuOTU1IDc4LjA0NTUgNDkuNjYzQzc3Ljc1MzUgNDkuMzcwOSA3Ny41Mzg4IDQ5LjAxMDcgNzcuNDIwOSA0OC42MTQ4TDczLjI5MDQgMzQuNzQ1MkM3My4xMzc2IDM0LjIzMiA3Mi44MjMyIDMzLjc4MTkgNzIuMzkzOSAzMy40NjE5QzcxLjk2NDcgMzMuMTQxOSA3MS40NDM2IDMyLjk2OSA3MC45MDgyIDMyLjk2OUM3MC4zNzI4IDMyLjk2OSA2OS44NTE3IDMzLjE0MTkgNjkuNDIyNCAzMy40NjE5QzY4Ljk5MzIgMzMuNzgxOSA2OC42Nzg4IDM0LjIzMiA2OC41MjYgMzQuNzQ1Mkw2NC4zOTU0IDQ4LjYxNDhDNjQuMjc3NiA0OS4wMTA3IDY0LjA2MjkgNDkuMzcwOSA2My43NzA4IDQ5LjY2M0M2My40Nzg4IDQ5Ljk1NSA2My4xMTg1IDUwLjE2OTcgNjIuNzIyNyA1MC4yODc2TDEuNzc2MTggNTQuNDE4MUMxLjI2MzA1IDU0LjU3MDkgMC44MTI5NTYgNTQuODg1MyAwLjQ5MjkyIDU1LjMxNDZDMC4xNzI4ODQgNTUuNzQzOCAyLjI0NzU1ZS0wNiA1Ni4yNjQ5IDAgNTYuODAwM0MtMi4yNDc1MWUtMDYgNTcuMzM1NyAwLjE3Mjg4NyA1Ny44NTY4IDAuNDkyOTIgNTguMjg2MUMwLjgxMjk1MyA1OC43MTUzIDEuMjYzMDMgNTkuMDI5NyAxLjc3NjE3IDU5LjE4MjZaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTMyLjE2MzcgMjkuNDg2OEw0MC4zNTc4IDMxLjkyNzFDNDAuNTkxNyAzMS45OTY3IDQwLjgwNDUgMzIuMTIzNiA0MC45NzcgMzIuMjk2MUM0MS4xNDk2IDMyLjQ2ODcgNDEuMjc2NCAzMi42ODE1IDQxLjM0NjEgMzIuOTE1NEw0My43ODYzIDQxLjEwOTVDNDMuODc2NiA0MS40MTI2IDQ0LjA2MjQgNDEuNjc4NSA0NC4zMTYgNDEuODY3NkM0NC41Njk2IDQyLjA1NjcgNDQuODc3NCA0Mi4xNTg4IDQ1LjE5MzcgNDIuMTU4OEM0NS41MTAxIDQyLjE1ODggNDUuODE3OSA0Mi4wNTY3IDQ2LjA3MTUgNDEuODY3NkM0Ni4zMjUxIDQxLjY3ODUgNDYuNTEwOSA0MS40MTI2IDQ2LjYwMTEgNDEuMTA5NUw0OS4wNDE0IDMyLjkxNTRDNDkuMTExMSAzMi42ODE1IDQ5LjIzNzkgMzIuNDY4NyA0OS40MTA0IDMyLjI5NjFDNDkuNTgzIDMyLjEyMzYgNDkuNzk1OCAzMS45OTY3IDUwLjAyOTcgMzEuOTI3MUw1OC4yMjM4IDI5LjQ4NjhDNTguNTI2OSAyOS4zOTY2IDU4Ljc5MjggMjkuMjEwOCA1OC45ODE5IDI4Ljk1NzJDNTkuMTcxIDI4LjcwMzYgNTkuMjczMSAyOC4zOTU4IDU5LjI3MzEgMjguMDc5NEM1OS4yNzMxIDI3Ljc2MzEgNTkuMTcxIDI3LjQ1NTMgNTguOTgxOSAyNy4yMDE3QzU4Ljc5MjggMjYuOTQ4MSA1OC41MjY5IDI2Ljc2MjMgNTguMjIzOCAyNi42NzJMNTAuMDI5NiAyNC4yMzE3QzQ5Ljc5NTggMjQuMTYyMSA0OS41ODI5IDI0LjAzNTIgNDkuNDEwNCAyMy44NjI3QzQ5LjIzNzkgMjMuNjkwMiA0OS4xMTEgMjMuNDc3MyA0OS4wNDE0IDIzLjI0MzRMNDYuNjAxMSAxNS4wNDkzQzQ2LjUxMDggMTQuNzQ2MiA0Ni4zMjUgMTQuNDgwMyA0Ni4wNzE1IDE0LjI5MTJDNDUuODE3OSAxNC4xMDIxIDQ1LjUxIDE0IDQ1LjE5MzcgMTRDNDQuODc3NCAxNCA0NC41Njk1IDE0LjEwMjEgNDQuMzE1OSAxNC4yOTEyQzQ0LjA2MjMgMTQuNDgwMyA0My44NzY2IDE0Ljc0NjIgNDMuNzg2MyAxNS4wNDkzTDQxLjM0NiAyMy4yNDM0QzQxLjI3NjQgMjMuNDc3MyA0MS4xNDk1IDIzLjY5MDIgNDAuOTc3IDIzLjg2MjdDNDAuODA0NCAyNC4wMzUyIDQwLjU5MTYgMjQuMTYyMSA0MC4zNTc4IDI0LjIzMTdMMzIuMTYzNyAyNi42NzJDMzEuODYwNSAyNi43NjIyIDMxLjU5NDYgMjYuOTQ4IDMxLjQwNTUgMjcuMjAxNkMzMS4yMTY0IDI3LjQ1NTIgMzEuMTE0MyAyNy43NjMxIDMxLjExNDMgMjguMDc5NEMzMS4xMTQzIDI4LjM5NTggMzEuMjE2NCAyOC43MDM3IDMxLjQwNTUgMjguOTU3MkMzMS41OTQ2IDI5LjIxMDggMzEuODYwNSAyOS4zOTY2IDMyLjE2MzcgMjkuNDg2OFoiIGZpbGw9ImJsYWNrIi8+Cjwvc3ZnPgo=';\n  \n  export function setupBitteWallet({\n    walletUrl = '',\n    deprecated = false,\n    successUrl = '',\n    failureUrl = '',\n    callbackUrl = '',\n    contractId = '',\n  }: BitteWalletSetup = {}): WalletModuleFactory<BrowserWallet> {\n  \n    return async (moduleOptions): Promise<WalletModule<BrowserWallet> | null> => {\n  \n      const wallet: WalletModule<BrowserWallet> = {\n        id: 'bitte-wallet',\n        type: 'browser',\n        metadata: {\n          name: 'Bitte Wallet',\n          description:\n            'NEAR wallet to store, buy, send and stake assets for DeFi.',\n          iconUrl: icon,\n          deprecated,\n          available: true,\n          successUrl,\n          failureUrl,\n          walletUrl: resolveBitteWallet(moduleOptions.options.network.networkId, walletUrl),\n        },\n        init: (options) => {\n          return BitteWallet({ callback: callbackUrl, networkId: moduleOptions.options.network.networkId, successUrl, failureUrl, contractId,  ...options });\n        },\n      };\n      return wallet;\n    };\n  }\n  "],"mappings":"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","names":["_0","callback"]}